import axios from 'axios';

export async function load({ params }: { params: any }) {
	const BASE_URL = import.meta.env.VITE_BACKEND_API_URL ?? 'https://api.congressstockwatch.com';

	const searchParams = {
		ticker: params.ticker
	};

	try {
		const profile = await axios.get(`${BASE_URL}/stock/profile`, {
			params: searchParams
		});

		const news = await axios.get(`${BASE_URL}/stock/news`, {
			params: searchParams
		});
		const stockData = await axios.get(`${BASE_URL}/stock/history`, {
			params: searchParams
		});

		const mockData = {
			dates: [
				'2025-03-05',
				'2025-03-06',
				'2025-03-07',
				'2025-03-10',
				'2025-03-11',
				'2025-03-12',
				'2025-03-13',
				'2025-03-14',
				'2025-03-17',
				'2025-03-18',
				'2025-03-19',
				'2025-03-20',
				'2025-03-21',
				'2025-03-24',
				'2025-03-25',
				'2025-03-26',
				'2025-03-27',
				'2025-03-28',
				'2025-03-31',
				'2025-04-01',
				'2025-04-02',
				'2025-04-03',
				'2025-04-04',
				'2025-04-07',
				'2025-04-08',
				'2025-04-09',
				'2025-04-10',
				'2025-04-11',
				'2025-04-14',
				'2025-04-15',
				'2025-04-16',
				'2025-04-17',
				'2025-04-21',
				'2025-04-22',
				'2025-04-23',
				'2025-04-24',
				'2025-04-25',
				'2025-04-28',
				'2025-04-29',
				'2025-04-30',
				'2025-05-01',
				'2025-05-02',
				'2025-05-05',
				'2025-05-06',
				'2025-05-07',
				'2025-05-08',
				'2025-05-09',
				'2025-05-12',
				'2025-05-13',
				'2025-05-14',
				'2025-05-15',
				'2025-05-16',
				'2025-05-19',
				'2025-05-20',
				'2025-05-21',
				'2025-05-22',
				'2025-05-23',
				'2025-05-27',
				'2025-05-28',
				'2025-05-29',
				'2025-05-30',
				'2025-06-02',
				'2025-06-03',
				'2025-06-04',
				'2025-06-05',
				'2025-06-06',
				'2025-06-09',
				'2025-06-10',
				'2025-06-11',
				'2025-06-12',
				'2025-06-13',
				'2025-06-16',
				'2025-06-17',
				'2025-06-18',
				'2025-06-20',
				'2025-06-23',
				'2025-06-24',
				'2025-06-25',
				'2025-06-26',
				'2025-06-27',
				'2025-06-30',
				'2025-07-01',
				'2025-07-02',
				'2025-07-03',
				'2025-07-07',
				'2025-07-08',
				'2025-07-09',
				'2025-07-10',
				'2025-07-11',
				'2025-07-14',
				'2025-07-15',
				'2025-07-16',
				'2025-07-17',
				'2025-07-18',
				'2025-07-21',
				'2025-07-22',
				'2025-07-23',
				'2025-07-24',
				'2025-07-25',
				'2025-07-28',
				'2025-07-29',
				'2025-07-30',
				'2025-07-31',
				'2025-08-01',
				'2025-08-04',
				'2025-08-05',
				'2025-08-06',
				'2025-08-07',
				'2025-08-08',
				'2025-08-11',
				'2025-08-12',
				'2025-08-13',
				'2025-08-14',
				'2025-08-15',
				'2025-08-18',
				'2025-08-19',
				'2025-08-20',
				'2025-08-21',
				'2025-08-22',
				'2025-08-25',
				'2025-08-26',
				'2025-08-27',
				'2025-08-28',
				'2025-08-29',
				'2025-09-02',
				'2025-09-03',
				'2025-09-04'
			],
			prices: [
				235.1643829345703, 234.75538635253906, 238.4862518310547, 226.92454528808594,
				220.30075073242188, 216.45018005371094, 209.16799926757812, 212.9687042236328,
				213.4774627685547, 212.17066955566406, 214.7144317626953, 213.5772247314453,
				217.73704528808594, 220.19102478027344, 223.2036590576172, 220.98907470703125,
				223.3034210205078, 217.36793518066406, 221.58761596679688, 222.64503479003906,
				223.34332275390625, 202.69384765625, 187.92002868652344, 181.0169219970703,
				171.9989776611328, 198.3644561767578, 189.9550323486328, 197.66615295410156,
				202.02549743652344, 201.6464080810547, 193.79563903808594, 196.4990234375,
				192.6883544921875, 199.25228881835938, 204.1004180908203, 207.8612060546875,
				208.76898193359375, 209.62689208984375, 210.6942901611328, 211.9811248779297,
				212.79913330078125, 204.8485870361328, 198.40435791015625, 198.02528381347656,
				195.7707977294922, 197.00778198242188, 198.0452423095703, 210.55104064941406,
				212.68861389160156, 212.08929443359375, 211.21029663085938, 211.0205078125,
				208.54331970214844, 206.62550354003906, 201.86090087890625, 201.13172912597656,
				195.04864501953125, 199.98304748535156, 200.1927947998047, 199.72332763671875,
				200.622314453125, 201.47134399414062, 203.03956604003906, 202.590087890625,
				200.40257263183594, 203.68882751464844, 201.2216339111328, 202.44024658203125,
				198.55465698242188, 198.97418212890625, 196.227294921875, 198.195068359375,
				195.418212890625, 196.35714721679688, 200.7721405029297, 201.27157592773438,
				200.07293701171875, 201.33151245117188, 200.7721405029297, 200.85205078125,
				204.93740844726562, 207.58441162109375, 212.1991729736328, 213.30792236328125,
				209.7119903564453, 209.7719268798828, 210.90065002441406, 212.16920471191406,
				210.92062377929688, 208.3834991455078, 208.87295532226562, 209.92176818847656,
				209.78192138671875, 210.9405975341797, 212.23912048339844, 214.15695190429688,
				213.9072265625, 213.51766967773438, 213.63754272460938, 213.80735778808594,
				211.03050231933594, 208.81301879882812, 207.33470153808594, 202.1505889892578,
				203.11949157714844, 202.68995666503906, 213.0082550048828, 219.7805633544922,
				229.0900115966797, 227.17999267578125, 229.64999389648438, 233.3300018310547,
				232.77999877929688, 231.58999633789062, 230.88999938964844, 230.55999755859375,
				226.00999450683594, 224.89999389648438, 227.75999450683594, 227.16000366210938,
				229.30999755859375, 230.49000549316406, 232.55999755859375, 232.13999938964844,
				229.72000122070312, 238.47000122070312, 239.77999877929688
			]
		};

		return {
			ticker: params.ticker,
			company: profile.data,
			news: news.data.slice(0, 20),
			stockHistory: stockData.data.data
			// stockHistory: mockData
		};
	} catch (e) {
		console.log(e);
		return;
	}
}
